<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Starium Rafa Quality Control Tool</title>
    <style>
        :root {
            --bg-color: #121212;
            --card-bg: #1E1E1E;
            --text-main: #E0E0E0;
            --accent-blue: #00BCD4; /* Safety Cyan */
            --accent-green: #00E676; /* Bright Green */
            --accent-red: #FF1744;   /* Bright Red */
            --accent-yellow: #FFEA00;
            --input-bg: #2C2C2C;
            --shadow: 0 4px 12px rgba(0,0,0,0.5);
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            transition: background-color 0.3s ease;
        }

        /* --- Header Styling --- */
        header {
            text-align: center;
            padding: 2rem 1rem;
            width: 100%;
            max-width: 800px;
            animation: slideDown 0.8s ease-out;
        }

        h1 {
            font-size: 2.5rem;
            color: var(--accent-blue);
            text-shadow: 0 0 10px rgba(0, 188, 212, 0.3);
            margin-bottom: 0.5rem;
            letter-spacing: 1px;
        }

        h2 {
            font-size: 1.5rem;
            color: var(--text-main);
            font-weight: 300;
            margin-top: 0;
            opacity: 0.9;
            transition: all 0.5s ease;
        }

        /* --- Controls Section --- */
        .controls {
            background-color: var(--card-bg);
            padding: 1.5rem;
            border-radius: 15px;
            box-shadow: var(--shadow);
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            width: 90%;
            max-width: 600px;
            margin-bottom: 2rem;
            animation: fadeIn 1s ease-out 0.3s backwards;
        }

        .input-group {
            position: relative;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        label {
            font-size: 0.9rem;
            color: #aaa;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        select, input {
            background-color: var(--input-bg);
            border: 2px solid #444;
            color: white;
            padding: 1rem;
            font-size: 1.2rem;
            border-radius: 8px;
            outline: none;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        select:focus, input:focus {
            border-color: var(--accent-blue);
            box-shadow: 0 0 15px rgba(0, 188, 212, 0.2);
            transform: scale(1.02);
        }

        /* --- Results Area --- */
        #results-area {
            width: 90%;
            max-width: 1000px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 200px;
            margin-bottom: 4rem;
        }

        /* Level 9 Result Animation */
        .level9-result {
            font-size: 1.8rem;
            color: #FFFFFF;
            text-align: center;
            margin-bottom: 2rem;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            animation: sparklePulse 2s infinite ease-in-out;
        }

        /* Grid for Machines */
        .machines-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 1rem;
            width: 100%;
            animation: fadeInUp 0.5s ease-out;
        }

        .machine-btn {
            background: linear-gradient(145deg, #2a2a2a, #333);
            border: none;
            color: white;
            padding: 1.5rem 0.5rem;
            border-radius: 12px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1.1rem;
            box-shadow: 5px 5px 10px #151515, -5px -5px 10px #3d3d3d;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
        }

        .machine-btn:hover {
            transform: translateY(-5px);
            background: var(--accent-blue);
            color: #000;
            box-shadow: 0 10px 20px rgba(0, 188, 212, 0.4);
        }

        .machine-btn:active {
            transform: scale(0.95);
        }

        /* BOT Density Display */
        .bot-display {
            background-color: var(--card-bg);
            padding: 3rem;
            border-radius: 20px;
            text-align: center;
            box-shadow: var(--shadow);
            width: 100%;
            max-width: 500px;
            animation: popIn 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            border: 3px solid transparent;
            box-sizing: border-box; /* Important for padding responsiveness */
        }

        .bot-value {
            font-size: 4rem;
            font-weight: 800;
            margin: 1rem 0;
            font-family: 'Courier New', Courier, monospace;
        }

        .bot-label {
            font-size: 1.2rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: #888;
        }

        .status-msg {
            font-size: 1.5rem;
            font-weight: bold;
            margin-top: 1rem;
        }

        /* Status Colors & Animations */
        .status-ok {
            color: var(--accent-green);
            border-color: var(--accent-green);
            box-shadow: 0 0 30px rgba(0, 230, 118, 0.2);
        }

        .status-danger {
            color: var(--accent-red);
            border-color: var(--accent-red);
            animation: pulseRed 1.5s infinite;
        }

        /* --- Modal (Popup) --- */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: var(--card-bg);
            padding: 2.5rem;
            border-radius: 20px;
            width: 90%;
            max-width: 400px;
            transform: scale(0.8);
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 0 40px rgba(0, 188, 212, 0.2);
            border: 1px solid #333;
            text-align: center;
        }

        .modal-overlay.active .modal-content {
            transform: scale(1);
        }

        .modal-title {
            font-size: 2rem;
            color: var(--accent-blue);
            margin-bottom: 1.5rem;
            border-bottom: 1px solid #333;
            padding-bottom: 1rem;
        }

        .modal-info {
            display: flex;
            justify-content: space-between;
            margin: 1rem 0;
            font-size: 1.2rem;
            border-bottom: 1px dashed #333;
            padding-bottom: 0.5rem;
        }

        .modal-label { color: #888; }
        .modal-value { color: white; font-weight: bold; }

        /* --- Footer --- */
        footer {
            margin-top: auto;
            padding: 2rem;
            text-align: center;
            color: #666;
            font-size: 0.9rem;
            cursor: default;
            position: relative;
            height: 30px; /* Fix height to prevent jump */
        }

        .footer-content {
            transition: opacity 0.4s ease, transform 0.4s ease;
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            white-space: nowrap;
        }

        .footer-contact {
            opacity: 0;
            transform: translateX(-50%) translateY(10px);
            color: var(--accent-green);
            font-weight: bold;
        }

        footer:hover .footer-copyright {
            opacity: 0;
            transform: translateX(-50%) translateY(-10px);
        }

        footer:hover .footer-contact {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        /* --- Animations --- */
        @keyframes slideDown {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes popIn {
            from { opacity: 0; transform: scale(0.5); }
            to { opacity: 1; transform: scale(1); }
        }

        @keyframes pulseRed {
            0% { box-shadow: 0 0 0 0 rgba(255, 23, 68, 0.4); }
            70% { box-shadow: 0 0 0 20px rgba(255, 23, 68, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 23, 68, 0); }
        }

        @keyframes sparklePulse {
            0% {
                transform: scale(1);
                text-shadow: 0 0 4px rgba(255, 255, 255, 0.6);
            }
            50% {
                transform: scale(1.05); /* Grow slightly */
                text-shadow: 0 0 20px rgba(255, 255, 255, 1), 0 0 35px var(--accent-blue); /* Glowing sparkle */
            }
            100% {
                transform: scale(1);
                text-shadow: 0 0 4px rgba(255, 255, 255, 0.6);
            }
        }

        /* --- Media Queries (Responsiveness) --- */
        @media (max-width: 600px) {
            h1 { font-size: 2rem; }
            
            .controls {
                padding: 1rem;
                width: 95%;
            }

            .bot-display {
                padding: 1.5rem; /* Reduced padding */
                width: 85%;      /* Width fits screen */
            }

            .bot-value {
                font-size: 3rem; /* Smaller font */
            }

            .bot-label {
                font-size: 1rem;
            }

            .level9-result {
                font-size: 1.4rem; /* Smaller text for mobile */
            }

            .footer-content {
                font-size: 0.8rem;
            }
        }

    </style>
</head>
<body>

    <header>
        <h1>Starium Rafa Quality Control Tool</h1>
        <h2 id="subtitle">Level 9 Silo Densities</h2>
    </header>

    <div class="controls">
        <div class="input-group">
            <label for="mode-select">Select Mode</label>
            <select id="mode-select">
                <option value="level9">Level 9 Silo Densities</option>
                <option value="bot">BOT Densities</option>
            </select>
        </div>

        <div class="input-group">
            <label for="weight-input">Powder Weight (g)</label>
            <input type="number" id="weight-input" placeholder="Enter weight..." autocomplete="off">
        </div>
    </div>

    <div id="results-area">
        <!-- Content will be injected here via JavaScript -->
        <div style="color: #555; font-style: italic;">Enter a weight to see results...</div>
    </div>

    <!-- Modal Structure -->
    <div class="modal-overlay" id="modal">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-title" id="m-title">Machine 01</div>
            <div class="modal-info">
                <span class="modal-label">Line:</span>
                <span class="modal-value" id="m-line">1A</span>
            </div>
            <div class="modal-info">
                <span class="modal-label">Configuration:</span>
                <span class="modal-value" id="m-gram">125g</span>
            </div>
            <div class="modal-info">
                <span class="modal-label">Allowed Range:</span>
                <span class="modal-value" id="m-range">0.200 - 0.270</span>
            </div>
            <div style="margin-top: 2rem; font-size: 0.8rem; color: #666;">
                Click outside to close
            </div>
        </div>
    </div>

    <footer>
        <div class="footer-content footer-copyright">
            &copy; <span id="year">2026</span> Dammie Optimus Solutions. All rights reserved.
        </div>
        <div class="footer-content footer-contact">
            WhatsApp Dammie Optimus Solutions on 07053331253
        </div>
    </footer>

    <script>
        /* 
         * =========================================
         * DATA CONFIGURATION
         * =========================================
         */
        
        // Machine Configuration Data
        // Map machine ID to its config
        const machines = [];
        const machineConfigs = [
            { ids: [1, 6], gram: 125, min: 0.200, max: 0.270 },
            { ids: [2, 3, 4, 5, 7, 8, 9, 11, 12, 13, 14, 15, 17, 18, 19, 20], gram: 85, min: 0.240, max: 0.300 },
            { ids: [10], gram: 22, min: 0.200, max: 0.310 },
            { ids: [22, 23, 24, 25, 27, 28, 29, 30], gram: 45, min: 0.210, max: 0.310 },
            { ids: [16, 21, 26], gram: 850, min: 0.200, max: 0.270 }
        ];

        // Line Mappings
        const lines = {
            '1A': [1, 2, 3, 4, 5],
            '1B': [6, 7, 8, 9, 10],
            '2A': [11, 12, 13, 14, 15],
            '2B': [16, 17, 18, 19, 20],
            '3A': [21, 22, 23, 24, 25],
            '3B': [26, 27, 28, 29, 30]
        };

        // Initialize Machine Objects
        for (let i = 1; i <= 30; i++) {
            let config = machineConfigs.find(c => c.ids.includes(i));
            let lineName = Object.keys(lines).find(key => lines[key].includes(i));
            
            machines.push({
                id: i,
                line: lineName,
                gram: config.gram,
                min: config.min,
                max: config.max
            });
        }

        /* 
         * =========================================
         * CONSTANTS & VOLUMES
         * =========================================
         */
        const LEVEL_9_VOLUME = 1580; // ml
        const BOT_VOLUME = 1680;     // ml
        const BOT_MIN_SAFE = 0.200;
        const BOT_MAX_SAFE = 0.240;

        /* 
         * =========================================
         * APP LOGIC
         * =========================================
         */

        // Elements
        const modeSelect = document.getElementById('mode-select');
        const weightInput = document.getElementById('weight-input');
        const resultsArea = document.getElementById('results-area');
        const subtitle = document.getElementById('subtitle');
        const modal = document.getElementById('modal');
        const yearSpan = document.getElementById('year');

        // Set Current Year
        yearSpan.textContent = new Date().getFullYear();

        // --- Event Listeners ---

        // Input Click (Clear all)
        weightInput.addEventListener('click', () => {
            weightInput.value = '';
            resultsArea.innerHTML = '<div style="color: #555; font-style: italic;">Enter a weight to see results...</div>';
            weightInput.focus();
        });

        // Mode Change
        modeSelect.addEventListener('change', (e) => {
            const mode = e.target.value;
            weightInput.value = '';
            resultsArea.innerHTML = '<div style="color: #555; font-style: italic;">Enter a weight to see results...</div>';
            
            if (mode === 'level9') {
                subtitle.textContent = "Level 9 Silo Densities";
            } else {
                subtitle.textContent = "BOT Densities";
            }
        });

        // Input Logic (Typing)
        weightInput.addEventListener('keyup', (e) => {
            const weight = parseFloat(e.target.value);
            const mode = modeSelect.value;
            
            if (!weight || isNaN(weight)) {
                resultsArea.innerHTML = '<div style="color: #555; font-style: italic;">Enter a weight to see results...</div>';
                return;
            }

            if (mode === 'level9') {
                handleLevel9Logic(weight);
            } else {
                handleBotLogic(weight);
            }
        });

        // Modal Close
        modal.addEventListener('click', () => {
            modal.classList.remove('active');
        });

        // --- Logic Functions ---

        function handleLevel9Logic(weight) {
            // Formula: Mass / Volume (1580)
            // Fixed to 3 decimal places and converted back to number for comparison
            const density = parseFloat((weight / LEVEL_9_VOLUME).toFixed(3));
            
            // New Sparkling Text Display
            resultsArea.innerHTML = `
                <div class="level9-result">
                    Density for ${weight}g is ${density.toFixed(3)}
                </div>
                <div class="machines-grid" id="machines-container"></div>
            `;

            const container = document.getElementById('machines-container');
            let found = false;

            machines.forEach(machine => {
                // Check if calculated density falls within machine range
                if (density >= machine.min && density <= machine.max) {
                    found = true;
                    const btn = document.createElement('button');
                    btn.className = 'machine-btn';
                    btn.textContent = `Machine ${machine.id}`;
                    btn.onclick = (e) => {
                        e.stopPropagation(); // Prevent input clear if bubbling
                        showModal(machine);
                    };
                    container.appendChild(btn);
                }
            });

            if (!found) {
                container.innerHTML = '<div style="grid-column: 1/-1; text-align: center; color: var(--accent-red); font-size: 1.2rem;">No machines accept this density.</div>';
            }
        }

        function handleBotLogic(weight) {
            // Formula: Mass / Volume (1680)
            const density = parseFloat((weight / BOT_VOLUME).toFixed(3));
            
            let statusClass = 'status-ok';
            let statusText = 'DENSITY NORMAL';
            let color = 'var(--accent-green)';

            // Updated Thresholds: Low < 0.200, High > 0.240
            if (density < BOT_MIN_SAFE) {
                statusClass = 'status-danger';
                statusText = 'DENSITY TOO LOW';
                color = 'var(--accent-red)';
            } else if (density > BOT_MAX_SAFE) {
                statusClass = 'status-danger';
                statusText = 'DENSITY TOO HIGH';
                color = 'var(--accent-red)';
            }

            resultsArea.innerHTML = `
                <div class="bot-display ${statusClass}">
                    <div class="bot-label">Base Powder Density</div>
                    <div class="bot-value" style="color: ${color}">${density.toFixed(3)}</div>
                    <div class="status-msg" style="color: ${color}">${statusText}</div>
                </div>
            `;
        }

        function showModal(machine) {
            document.getElementById('m-title').textContent = `Machine ${machine.id}`;
            document.getElementById('m-line').textContent = machine.line;
            document.getElementById('m-gram').textContent = `${machine.gram}g`;
            document.getElementById('m-range').textContent = `${machine.min.toFixed(3)} - ${machine.max.toFixed(3)}`;
            
            modal.classList.add('active');
        }

    </script>
</body>
</html>
